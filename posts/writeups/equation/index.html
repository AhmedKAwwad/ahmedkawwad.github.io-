<!DOCTYPE html>
<html>
  <head>
    <title>Equat1on writeup</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>
<link rel="stylesheet" href="/css/plyr.css"/>
<link rel="stylesheet" href="/css/flag-icon.min.css"/>


<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600">


<link rel="stylesheet" href="/fontawesome/css/all.min.css"/>



<link rel="stylesheet" href="/css/colortheme/colortheme.css"/>





  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/k-icon-invert_hu853d0774892b5f84d30746ce0d4103bc_12477_42x0_resize_box_3.png" />

<meta property="og:title" content="Equat1on writeup" />
<meta property="og:description" content="Zain CTF 2022 ‚Äî Cybertalents" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ahmedkawwad.github.io/posts/writeups/equation/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-18T01:01:28+04:00" />
<meta property="article:modified_time" content="2022-03-18T01:01:28+04:00" />



    
    
<meta name="description" content="Zain CTF 2022 ‚Äî Cybertalents" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">

<link rel="stylesheet" href="/css/style.css"/>



    




</head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/k-icon-invert_hu853d0774892b5f84d30746ce0d4103bc_12477_42x0_resize_box_3.png" alt="Logo">
      Awwad&#39;s Blog</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      
        <li class="nav-item dropdown">

<div id="theme-initialization" style="display: none;"
  default-theme="system"></div>
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" src="/icons/moon-svgrepo-com.svg" width=20>
</a>
<div class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  <a class="dropdown-item nav-link" href="#" onclick="enableLightTheme()">
    <img class="menu-icon-center" src="/icons/sun-svgrepo-com.svg" width=20>
  </a>
  <a class="dropdown-item nav-link" href="#" onclick="enableDarkTheme()">
    <img class="menu-icon-center" src="/icons/moon-svgrepo-com.svg" width=20>
  </a>
  <a class="dropdown-item nav-link" href="#" onclick="useSystemTheme()">
    <img class="menu-icon-center" src="/icons/computer-svgrepo-com.svg" width=20>
  </a>
</div>
</li>
      
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/k-icon-invert_hu853d0774892b5f84d30746ce0d4103bc_12477_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/k-icon-invert_hu853d0774892b5f84d30746ce0d4103bc_12477_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="/posts/writeups/">Write ups</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/writeups/email/" title="Email Address">Email Address</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/writeups/equation/" title="Equat1on">Equat1on</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/writeups/squirrel/" title="Squirrel">Squirrel</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/posts/writeups/equation/hero.svg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/author/avatar3_huf5636dc089c392d128deee48ab1cfda5_92383_120x120_fit_q75_box.jpg' alt="Author Image">
          <h5 class="author-name">Ahmed Khaled A. Awwad</h5>
          <p>Friday, March 18, 2022</p>
        </div>

        <div class="title">
          <h1>Equat1on writeup</h1>
        </div>
        
        <div class="post-content" id="post-content">
          <h3 id="zain-ctf-2022--cybertalents">Zain CTF 2022 ‚Äî Cybertalents</h3>
<p>Description : You won&rsquo;t pass our gate!</p>
<p>Category: Crytpography</p>
<p>here is the challenge file , is a python code
as it seems open a file ‚Äúflag.txt‚Äù and read it</p>
<!DOCTYPE html>
<html>
<head>
  <style>
.button-dl {
  border:  2px solid #008CBA;/* Blue */
  border-radius: 9px;
  color: black;
  padding: 9px 10px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 15px;
  margin-left: 80px;
  cursor: pointer;
  background-color: #ffffff;
  transition-duration: 0.4s;
  box-shadow: 0 4px 10px 0 rgba(0,0,0,0.2), 0 4px 15px 0 rgba(0,0,0,0.19);
  }
.button-dl:hover {
  background-color: #008CBA; /* Blue */
  color: white;
}
.button-dl:active {
  background-color: #3e8e41;/* Green */
  box-shadow: 0 5px #666;
  transform: translateY(4px);
<p></style></p>
</head>
<body>
<p><a download =challenge.py  target = "_blank" class = "button-dl" href="/files/challenge.py" >Challenge.py</a></p>
<pre tabindex="0"><code>#!python3 
from math import *
with open(&#39;flag.txt&#39;,&#39;r&#39;) as fg:
  flag=fg.read()
</code></pre><h3 id="calcxval-function">calc(x,val) function:</h3>
<pre tabindex="0"><code>  def calc(x,val):
    return {
      0: lambda x: (x+1)/(x-1),
      1: lambda x: 984512/(x-69964)+69964
    }[val](x)
</code></pre><p>seems it check if ‚Äúval‚Äù is ‚Äú0‚Äù &gt; x = (x+1)/(x-1)
if ‚Äúval‚Äù is ‚Äú1‚Äù&gt; x = 984512/(x-69964)+69964
x is the ascii order passed to get_val(x,i)</p>
<h3 id="main-function">Main function:</h3>
<pre tabindex="0"><code>  enc=[]
  i= 0
  for L in flag:
    enc.append(get_val(ord(L),i))
    i+=1
</code></pre><p>read every letter in flag and read it with ord() which gets the Ascii order of the letter.</p>
<p>Then pass it to get_val() function and append it to enc variable ‚Äúenc.append()‚Äù</p>
<h3 id="get_val-xi-function">get_val (x,i) function:</h3>
<pre tabindex="0"><code>  def get_val(x,i):
    if ( i % 2 == 0 ):
      return calc(x,1)
    else:
      return calc(x,0)
</code></pre><p>seems it check if ‚Äúi‚Äù is even &gt; pass the x parameter and ‚Äú1‚Äù to calc() function
if ‚Äúi‚Äù is odd &gt; pass the x parameter and ‚Äú0‚Äù to calc() function
and there‚Äôs a comment down there</p>
<pre tabindex="0"><code>[69949.90776101458, 1.0186915887850467, 69949.90876951923, 1.0196078431372548, 69949.90352371817, 1.0277777777777777, 69949.90614710683, 1.017094017094017, 69949.90594534237, 1.0186915887850467, 69949.90473463427, 1.017391304347826, 69949.90715584248, 1.018181818181818, 69949.90614710683, 1.024390243902439, 69949.90917288068, 1.0208333333333333, 69949.90534001432, 1.04, 69949.90917288068, 1.02, 69949.90876951923, 1.0175438596491229, 69949.90392737999, 1.0212765957446808, 69949.90574357212, 1.02, 69949.90876951923, 1.0175438596491229, 69949.90392737999, 1.0212765957446808, 69981.0168870452, 1.0212765957446808, 69949.90513822675, 1.0178571428571428, 69949.90473463427, 1.0192307692307692, 69949.90372555197, 1.0166666666666666, 69949.90312003322, 1.2222222222222223]
</code></pre><p>seems like the flag results after the whole operation, then decided to reverse it</p>
<p>Then enc will be filled with ‚Äúasci order number ‚Äù of each character in flag after performing the above equation depends on his order in flag string which is in flag.txt ,</p>
<p>either odd order {1,3,5,‚Ä¶etc} or even order {0,2,4,..etc}
so, i reversed each equation in a function depending on their order too.</p>
<p>Here is the Mathematics part to get the Ascii order out of the &ldquo;enc&rdquo; value we reverse equation when i = 1 (even order) 
<br><br>
<img class = "img" src="/files/equ-even.JPG" alt="equation for even" width="250" height="150" style="vertical-align:middle;margin:0px 450px">
<br><br>
Here is the Mathematics part to get the Ascii order out of the &ldquo;enc&rdquo; value we reverse equation when i = 1 (odd order)
<br><br>
<img class = "img" src="/files/equ-odd.JPG" alt="equation for odd" width="350" height="150" style="vertical-align:middle;margin:0px 400px">
<br><br>
Here is how we can scripit that equation depending on order of each enc and return back the ascii order and then read it as letter.</p>
<p>then append each letter reversed from the commented enc list to ‚Äúflag‚Äù</p>
<p><a download =reverseEquation.py target = "_blank" class = "button-dl" href="/files/reverseEquation.py" >reverseEquation.py</a></p>
<p>Then the flag come up : <code>flag{InvolutionS_ar3_easy_peasy_üçã_squizy}</code></p>
</body>
</html>
        </div>

        
        <div class="row pl-3 pr-3">
        
        <div class="col-md-6 share-buttons">
        
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/AhmedKAwwad/ahmedkawwad.github.io/edit/source/content/posts%5cWriteups%5cequation%5cindex.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
    
    
  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/writeups/email/" title="Email Address writeup" class="btn btn-outline-info">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Email Address writeup</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/writeups/squirrel/" title="Squirrel writeup" class="btn btn-outline-info">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">Squirrel writeup</div>
        </a>
      </div>
    
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#zain-ctf-2022--cybertalents">Zain CTF 2022 ‚Äî Cybertalents</a></li>
        <li><a href="#calcxval-function">calc(x,val) function:</a></li>
        <li><a href="#main-function">Main function:</a></li>
        <li><a href="#get_val-xi-function">get_val (x,i) function:</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    










  
      
  



  
  
    
  

  
  
    
  

  
  

  
  
    
    
      
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://ahmedkawwad.github.io#me">About</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://ahmedkawwad.github.io#skills">Skills</a>
                </li>
              
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="https://ahmedkawwad.github.io#experiences">Experience</a>
                </li>
              
              
              
              
              
            
              
            
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
              
                <li><a href=mailto:a.k.awad97@gmail.com target="_blank" rel="noopener">
                  <span><i class="fas fa-envelope"></i></span> <span>a.k.awad97@gmail.com</span>
                </a></li>
              
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-left">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hossainemruz/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">¬© 2022 Copyright.</div>
        <div class="col-md-4 text-right">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="/js/popper.min.js"></script>
<script type="text/javascript" src="/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/js/navbar.js"></script>
<script type="text/javascript" src="/js/plyr.js"></script>
<script type="text/javascript" src="/js/main.js"></script>



<script type="text/javascript" src="/js/darkreader.js"></script>
<script type="text/javascript" src="/js/darkmode-darkreader.js"></script>



    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>









    
</body>
</html>
